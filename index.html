<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>秒杀你...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="lib/all.css">
    <link rel="shortcut icon" href="favicon.ico">
    <script type="text/javascript">
        document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);
    </script>
</head>
<body>

    <!-- loading -->
    <div class="img logImg">       
        <div class="sp">
            <p class="p1"></p>
        </div>      
        <div class="num">0%</div>
        <div class="num2"><img src="img/p0_pic4.png"></div>
    </div>


    <div id="audio_btn" class="audio_btn" url="audio/audio.mp3" class="">
        <audio loop="" src="" id="media" autoplay=""></audio>
    </div>
    <div id="swiperBox" class="swiper-container swiper-container-h opacity0" dir="rtl">
        <div class="swiper-wrapper swiper-wrapper1">

            <!--第一页开始-->
            <div class="swiper-slide" id="page1">

                <div class="slide_sec1 sec">
                    <div class="page1_img1 page1_img1_bg"><img class="blocks" src="img/bg1_1.png" alt=""></div>
                    <p class="page_img2 page1_Img"><img class="blocks" src="img/page1_03.png" class="" alt=""></p>
                </div>


            </div>
            <!--第一页结束-->


    
            <!--第二页开始-->
            <div class="swiper-slide swiper-no-swiping" id="page2">

                <div class="slide_sec2 sec">
                    <div class="page2_img">
                        <img src="img/big_bg.png" alt="">
                    </div>

    
                    <div class="sec_common2 opacity0" >
                        <img class="blocks sec_common2Img1 fadeOutRight" src="img/com_pic2.png" alt="">
                        <img class="blocks sec_common2Img1" src="img/com_pic1.png" alt="">
                    </div>


                    <div class="sec1">
                        <div class="sec_img1">
                            <img class="p1_pic1 blocks" src="img/p1_pic1.png" alt="">
                            <img class="p1_pic2 page_rotate p1_pic" src="img/p1_pic2.png" alt="">
                            <img class="p1_pic3 page_rotate p1_pic" src="img/p1_pic3.png" alt="">
                        </div>

                        <div class="sec1_img2 swing sec1_2s sec_Img position_a">
                            <div class="sec2Img">
                                <img src="img/p1_pic4.png" class="blocks" alt="">
                                <div class="sec2Img_div">
                                </div>
                            </div>
                            
                        </div>

                        <div class="sec1_img3 sec_Img sec1_3s position_a">
                            <img src="img/p1_pic5.png" class="blocks" alt="">
                        </div>

                        <div class="sec1_img4 sec_Img sec1_4s position_a">
                            <img src="img/p1_pic6.png" class="blocks" alt="">
                        </div>
        
                        <div class="sec1_img5 sec1_5s position_a">
                            <img src="img/p2_pic1.png" class="blocks" alt="">
                        </div>  


                    </div>

                    <div class="sec2 sec_div">
                        <img src="img/p3_pic1.png" class="blocks" alt="">




                    </div>

                    <div class="sec3 sec_div">
                        <img src="img/p4_pic1.png" class="blocks" alt="">
                    </div>
                </div>
                

            </div>
             <!--第二页结束-->





        </div>
        <!-- Add Pagination -->
        <div class="swiper-pagination swiper-pagination1" style="display:none;"></div>
        <!-- Add Navigation -->
        <div class="swiper-button-prev" style="display:none;"></div>
        <div class="swiper-button-next" style="display:none;"></div>

    </div>
    <!-- Swiper JS -->
    <script type="text/javascript" src="lib/all.js"></script>

    <script type="text/javascript">

    var step_funs = 0,
        step_fun_width = "",
        step_fun_mar = "";
    var ints = {
        that:this,
        flag:true,
        init:function(){
            var flag = this.flag;
            this.countdown_time();
            this.audio_control(flag);
        },
        tapClick:function(){
            return "ontouchstart" in document ? "tap" : "click";
        },
        audio_control:function(boolearn){
            var audio_btn = $('#audio_btn'),
                audio = $("#media")[0],
                Istrue_flase = boolearn;
                audio_btn.on('click',function(){
                    var that = $(this);
                    if(Istrue_flase == true){
                        audio.pause();
                        Istrue_flase = false;
                        that.addClass('off');
                    }else if(Istrue_flase == false){
                        audio.play(); 
                        Istrue_flase = true; 
                        that.removeClass('off');
                    }
                });
            
        },
        countdown_time:function(){
            var i=0,
                logImg = $('.logImg'),
                that = this,
                timer;
            timer=setInterval(function(){
                if(i>=100){
                    //更该页面
                    clearInterval(timer);
                    that.swiperH();
                    //that.swiperV();
                    // return false;
                    logImg.hide();
                    // $(".sex").find("a").on("tap",function(){
                    //     $(".sex").hide();
                    // });
                    // $(".constellation").find("dl").on("tap",function(){
                    //     $(".constellation").hide();
                    // });
                    return false;
                } 
                i+=2;
                logImg.find(".p1").css("width",i+"%");
                logImg.find(".num").html(i+"%");
            },50);//100
        },
        swiperH:function(){
            var opacity0 = $('#swiperBox');
            opacity0.css('opacity','1');
            var swiperH = new Swiper('.swiper-container.swiper-container-h', {
                pagination: '.swiper-pagination.swiper-pagination1',
                paginationClickable: true,
                noSwiping : true,
                effect : 'fade',
                nextButton: '.swiper-button-next',
                prevButton: '.swiper-button-prev',
                onTouchStart: function(swiper,even){
                    //console.log(swiper.activeIndex);  

                    // if(swiper.activeIndex == 0){
                    //     return false;
                    // }   
                    // a =  even.changedTouches[0].clientX;
                    // console.log(a);
                },
                onTouchMove: function(swiper,even){
                    // console.log(even.touches[0].clientX)
                    // console.log(even.changedTouches[0].clientX);
                    // console.log(even);

                  //你的事件
                },onTouchEnd:function(swiper,even){
                    setTimeout(function(){
                        $('.sec_common2').css('opacity','1');
                    },1000);
                }

            });
            this.swiperH_click(swiperH);
        },
        swiperH_click:function(swiperH){

            var that = this;
            var qic = $('.page_img2');
            qic.on('click',function(){
                $('.swiper-pagination1 span').eq(1).click();
                setTimeout(function(){
                    $('.sec_common2').css('opacity','1');
                },1000);
            });






            var start_x,move_x,end_x,ins = 0,
                flag = true;


                var touStart_step = 0;
                var is_touStart_step = 0;
                var start_mover = "";


            $('#page2').on('touchstart',function(e) {
                $('.sec_common2').css('opacity','0');
                var _touch = e.originalEvent.targetTouches[0]; 
                    start_x = _touch.pageX;
                    touStart_step++;
                    start_mover = "";
                    is_touStart_step = 0;
                    //console.log(start_x);

            });
           
            $('#page2').on('touchmove',function(e) {
                var _touch = e.originalEvent.targetTouches[0]; 
                move_x = _touch.pageX;
                  
                if(ins == 0 || (flag == true && ins <= 2 )){
             
             
                    is_touStart_step = 72;
                  

                    start_mover = move_x-start_x;

                      //console.log(start_mover);


                    if(start_mover > start_x){
                        is_touStart_step++;
                        $('.page2_img img').css({
                            '-webkit-transform':'rotate('+is_touStart_step+'deg)',
                            '-moz-transform':'rotate('+is_touStart_step+'deg)',
                            'transform':'rotate('+is_touStart_step+'deg)'
                        });
                    }else if(start_mover < start_x){
                        is_touStart_step--;
                        $('.page2_img img').css({
                            '-webkit-transform':'rotate('+-is_touStart_step+'deg)',
                            '-moz-transform':'rotate('+-is_touStart_step+'deg)',
                            'transform':'rotate('+-is_touStart_step+'deg)'
                        });
                    }


                }
                
                if(ins == 0){
                    var moveX = move_x-200;
                    $('.sec_Img').css({'-webkit-transform':'translate3d('+(move_x*1+80)+'px,0,0)','transform':'translate3d('+(move_x*1+80)+'px,0,0)'});
                   $('.sec1_img5').css({'-webkit-transform':'translateX('+moveX+'px)','transform':'translateX('+moveX+'px)'})
                }


            });
            var timrs1 = "";
            $('#page2').on('touchend',function(e) {
                
                if(flag == false){
                    return false;
                }

                $('.sec_Img').hide();
                var _touch = e.originalEvent.changedTouches[0]; 
                end_x =  _touch.pageX;
               
                var Calculation_x = move_x - start_x;
                    
                if(Calculation_x > 0){

                    if(ins == 0){
                        var deg = ins+1 * 72;
                    }else{
                        var deg = ins * 72;
                    }

                    ins++;
                    if(ins >= 4){
                        $('.swiper-pagination1 span').eq(2).click();
                        $('.sec_common2').css('opacity','0');

                        setTimeout(function(){
                            that.swiperV();
                        },400);

                        swiperH.destroy(false);
                        return false;
                    }   
                    $('.page2_img img').css({
                        '-webkit-transform':'rotate('+deg+'deg)',
                        '-moz-transform':'rotate('+deg+'deg)',
                        'transform':'rotate('+deg+'deg)'
                    });

                    flag = false;
                    clearInterval(timrs1);
                    timrs1 = setTimeout(function(){
                        flag = true;
                        $('.sec_common2').css('opacity','1');
                        if(ins == 1){

                        }else if(ins == 2){
                            $('.sec1').css('opacity','0');
                            $('.sec2').css('opacity','1');

                        }else if(ins == 3){
                            $('.sec2').css('opacity','0');
                            $('.sec3').css('opacity','1');
                        }             
                    },1300);
                }
            });

            $('button').on('tap',function(){
                $('.swiper-pagination1 span').eq(2).click();
            });


        },
        swiperV:function(){
            var that = this;
            var swiperV = new Swiper('.swiper-container.swiper-container-v', {
                pagination: '.swiper-pagination.swiper-pagination2',
                paginationClickable: true,
                direction: 'vertical',
                spaceBetween: 0 ,
                onInit: function(swiper){ //Swiper2.x的初始化是onFirstInit
                  swiperAnimateCache(swiper); //隐藏动画元素 
                  swiperAnimate(swiper); //初始化完成开始动画
                }, 
                onSlideChangeEnd: function(swiper){ 
                  swiperAnimate(swiper); //每个slide切换结束时也运行当前slide动画
                },
                onTouchStart: function(swiper,even){
                    //console.log(swiper.activeIndex)
                    //console.log(swiper.activeIndex);  
                    // if(swiper.activeIndex == 0){
                    //     return false;
                    // }   
                    // a =  even.changedTouches[0].clientX;
                    // console.log(a);
                },
                onTouchMove: function(swiper,even){
                    // console.log(even.touches[0].clientX)
                    // console.log(even.changedTouches[0].clientX);
                    // console.log(even);
                  //你的事件
                },onTouchEnd:function(swiper,even){
                    
                },onSlideChangeStart: function(swiper){

                }
            });
    
           that.swiperV_click(swiperV);
        },swiperV_click:function(swiperV){
            var step = 500,step_timer,that = this,is = 0,
                btn_xin = $('.vertica2_img2_div'),bth_lower = $('#bth_lower'),bth_lower2 = $('#bth_lower2')
            btn_xin.on('touchstart',function(e) {
                e.preventDefault();
                var that_this = $(this).siblings('img');
                step_timer = setInterval(function(){
                    step--;
                    if(step == 400){
                        that.step_fun();
                        that_this.attr('src','img/p6_pic4.png');
                    }else if(step == 360){
                        that.step_fun();
                    }else if(step == 320){
                        that.step_fun();
                    }else if(step == 260){
                        that.step_fun();
                    }else if(step == 240){
                        that.step_fun();
                    }else if(step < 200 || step <= 0){
                        that.step_end();
                        clearInterval(step_timer);
                    }else if(step <= 0){
                        clearInterval(step_timer);
                    }
                },0);
            });
            btn_xin.on('touchmove',function(e) {
                clearInterval(step_timer);
                $(this).siblings('img').attr('src','img/p6_pic4.png');
            })
            btn_xin.on('touchend',function(e) {
                clearInterval(step_timer);
                step_funs >= 5 && that.step_end();
            });
            bth_lower.on('click',function(){
                $('.swiper-pagination2 span').eq(2).click();
            })
            bth_lower2.on('click',function(){
                $('.vertica3_img1').css('opacity','1');
            })
         
        },
        step_fun:function(){
                step_funs++;
                if(step_funs == 1){
                    step_fun_mar = "-40px";
                }else if(step_funs == 2){
                    step_fun_mar = "-53px"
                }else if(step_funs == 3){
                    step_fun_mar = "-10px";
                    step_fun_mar = "-28px";
                }
                var x = 100;       
                var y = 900;  
                var num = Math.floor(Math.random() * 3 + 1);
                var index=$('.demo').children('img').length;
                var rand = parseInt(Math.random() * (x - y + 1) + y-10); 
                
                $(".demo").append("<img class='demo_img_scale' src=''>");
                $('.demo img:eq(' + index + ')').attr('src','img/p'+num+'.png');
               
                $(".demo img").animate({
                    bottom:"800px",
                    opacity:"0",
                    left: rand,
                    marginLeft:step_fun_mar,
                    width:'32px'
                },3000);

          
        },
        step_end:function(){
            $('.vertica2_p').css('opacity','1')
        }
    }
   
    window.onload= function(){
        ints.init();
    }

 
    </script>
</body>
</html>